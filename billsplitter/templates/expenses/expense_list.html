{% extends "base.html" %}
{% block page %}
	{% load i18n %}
	<h1 class="page-header">
		{% trans "Expenses" %}
		<div class="pull-right">
			<a class="btn btn-primary" href="{% url 'expense_create' %}"><i class="icon-white icon-plus"></i> {% trans "Add an expense" %}</a>
			<a class="btn" href="{% url 'refund_create' %}"><i class="icon-check"></i> {% trans "Refund someone" %}</a>
		</div>
	</h1>
	<div class="span4 pull-right">
		<table class="table table-striped table-bordered">
			<tbody>
				{% for user in users %}
					<tr>
						<td>{{ user.get_full_name }}</td>
						<td>{{ user.expenses_total|default:0|floatformat:2 }}$</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
	<table class="table table-striped">
		<thead>
			<tr>
				<th>{% trans "Title" %}</th>
				<th class="hidden-phone">{% trans "Description" %}</th>
				<th>{% trans "Buyer" %}</th>
				<th>{% trans "Date" %}</th>
				<th>{% trans "Amount" %}</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			{% for expense in expense_list %}
				{% if expense.refund_from %}
					<tr class="refund info">
						<td>{{ expense.refund_from }}</td>
						<td class="hidden-phone">{{ expense.description }}</td>
						<td>{{ expense.user }}</td>
						<td>{{ expense.date|date:"M d" }}</td>
						<td>{{ expense.amount|floatformat:2 }}$</td>
						<td align="right">
							<div class="pull-right">
								<a class="btn btn-small" href="{% url 'refund_delete' expense.refund_from.pk %}"><i class="icon-remove"></i></a>
							</div>
						</td>
					</tr>
				{% elif expense.refund_to %}
					{# Nothing, as expected #}
				{% else %}
					<tr>
						<td>{{ expense.title }}</td>
						<td class="hidden-phone">{{ expense.description }}</td>
						<td>{{ expense.user }}</td>
						<td>{{ expense.date|date:"M d" }}</td>
						<td>{{ expense.amount|floatformat:2 }}$</td>
						<td align="right">
							<div class="pull-right">
								<a class="btn btn-small" href="{% url 'expense_update' expense.pk %}"><i class="icon-pencil"></i><span class="hidden-phone"> {% trans "Edit expense" %}</span></a>
								<a class="btn btn-small" href="{% url 'expense_delete' expense.pk %}"><i class="icon-remove"></i></a>
							</div>
						</td>
					</tr>
				{% endif %}
			{% endfor %}
		</tbody>
	</table>
{% endblock page %}